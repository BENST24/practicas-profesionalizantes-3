<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Canvas Rectangle</title>
    <style>
        body 
        {
            width: 800px;
            height: 400px;
            border: 2px solid black;
        }
    </style>
</head>
<body>

<canvas id="myCanvas" width="800" height="400"></canvas>

<script>

class RectangleModel
{
    constructor(x, y, width, height, canvas, angle = 0) 
    {
        this._x = x;
        this._y = y;
        this._width = width;
        this._height = height;
        this._angle = angle;

        this.canvas = canvas;
        this.ctx = this.canvas.getContext('2d');

        this.draw();
    }

    rotate(radians) 
    {
        this._angle += radians;
        this.draw();
    }

    move(distance)
    {
        this._x += distance * Math.cos(this._angle);
        this._y += distance * Math.sin(this._angle);
        this.draw();
    }

    draw() 
    {
        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
        this.ctx.save();
        this.ctx.translate(this._x, this._y);
        this.ctx.rotate(this._angle);
        this.ctx.fillStyle = 'blue';
        this.ctx.fillRect(-this._width / 2, -this._height / 2, this._width, this._height);
        this.ctx.restore();
    }
}

class RectangleController
{
    constructor(model)
    {
        this.model = model;

        this.keys = 
        {
            ArrowUp: false,
            ArrowDown: false,
            ArrowLeft: false,
            ArrowRight: false
        };
    }

    init()
    {
        window.addEventListener("keydown", this.onKeyDownPressed.bind(this))
        window.addEventListener("keyup", this.onKeyDropUp.bind(this))
    }

    onKeyDownPressed( event )
    {
        if (event.key in this.keys) 
        {
            this.keys[event.key] = true;
        }

    }

    onKeyDropUp()
    {
        if (event.key in this.keys) 
        {
            this.keys[event.key] = false;
        }
    }

    update() 
    {

        if (this.keys.ArrowLeft) 
        {
            this.model.rotate(-0.05);
        }
        if (this.keys.ArrowRight) 
        {
            this.model.rotate(0.05);
        }
        if (this.keys.ArrowUp) 
        {
            this.model.move(2);
        }
        if (this.keys.ArrowDown) 
        {
            this.model.move(-2);
        }
    }
}

function main() 
{
    const canvas = document.getElementById('myCanvas');

    const rectModel = new RectangleModel(200, 200, 50, 25, canvas);
    const rectControl = new RectangleController(rectModel);

    rectControl.init();

    rectControl.update();

    setInterval(() => rectControl.update(), 16);
}

window.onload = main;
</script>

</body>
</html>